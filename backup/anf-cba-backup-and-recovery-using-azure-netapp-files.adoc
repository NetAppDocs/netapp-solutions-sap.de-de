---
sidebar: sidebar 
permalink: backup/anf-cba-backup-and-recovery-using-azure-netapp-files.html 
keywords: runtime, backup, recovery, restore, recover 
summary: 'Mit der Azure NetApp Files (ANF) Snapshot Technologie lassen sich Datenbank-Backups in Sekundenschnelle erstellen. Wie lange es dauert, eine Snapshot Kopie zu erstellen, ist unabhängig von der Größe der Datenbank, da bei Snapshot Kopien keine physischen Datenblöcke auf der Storage-Plattform verschoben werden. Darüber hinaus wirkt sich der Einsatz der Snapshot-Technologie auf das laufende SAP-System nicht auf die Performance aus.' 
---
= Backup und Recovery mit Azure NetApp Files
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


link:anf-cba-overview.html["Zurück: Übersicht."]

[role="lead"]
Mit der Azure NetApp Files (ANF) Snapshot Technologie lassen sich Datenbank-Backups in Sekundenschnelle erstellen. Wie lange es dauert, eine Snapshot Kopie zu erstellen, ist unabhängig von der Größe der Datenbank, da bei Snapshot Kopien keine physischen Datenblöcke auf der Storage-Plattform verschoben werden. Darüber hinaus wirkt sich der Einsatz der Snapshot-Technologie auf das laufende SAP-System nicht auf die Performance aus. Daher können Sie die Erstellung von Snapshot Kopien so planen, dass die Zeiten für Spitzenzeiten oder Batch-Aktivitäten nicht berücksichtigt werden. Kunden mit SAP auf ANF planen in der Regel mehrere Online Snapshot Backups tagsüber. Beispielsweise sind alle vier bis sechs Stunden üblich. Diese Snapshot Backups werden in der Regel drei bis fünf Tage auf dem primären Storage-System gespeichert, bevor sie entfernt werden.

Snapshot Kopien bieten auch wichtige Vorteile für Wiederherstellung und Recovery. Ein Vorgang zur Wiederherstellung des Volumes ermöglicht die Wiederherstellung einer vollständigen Datenbank auf Basis der verfügbaren Snapshot Kopien zu einem beliebigen Zeitpunkt. Solche Wiederherstellungen sind innerhalb von wenigen Sekunden abgeschlossen, unabhängig von der Größe der Datenbank. Da mehrere Online Snapshot Backups tagsüber erstellt werden, verringert sich die für den Recovery-Prozess erforderliche Zeit im Vergleich zu einem herkömmlichen Backup-Ansatz deutlich. Da ein Restore-Vorgang mit einer Snapshot-Kopie durchgeführt werden kann, die nur wenige Stunden alt ist (und nicht bis zu 24 Stunden), müssen weniger Transaktions-Logs angewendet werden. Somit reduziert sich die RTO auf mehrere Minuten anstatt auf mehrere Stunden für herkömmliche Single-Cycle Backups.

Backups von Snapshot-Kopien werden auf demselben Festplattensystem wie die aktiven Online-Daten gespeichert. Daher empfiehlt NetApp, Backups von Snapshot-Kopien als Ergänzung zu verwenden, anstatt Backups an einen sekundären Standort zu ersetzen. Die meisten Wiederherstellungs- und Recovery-Aktionen werden mittels eines Umkehrvorgangs auf dem primären Storage-System durchgeführt. Restores von einem Sekundärstandort sind nur nötig, wenn das primäre Storage-System, das die Snapshot-Kopien enthält, beschädigt ist. Sie können den sekundären Standort verwenden, falls ein Backup wiederhergestellt werden muss, das nicht mehr in einer Snapshot Kopie verfügbar ist.

Sie können Backups mithilfe von zusätzlichen HANA-dateibasierten Backups an einem sekundären Standort erstellen. Diese dateibasierten Backups können wesentlich häufiger und somit mit weniger Auswirkungen auf die Performance des Produktionssystems geplant werden.



== Laufzeit von Snapshot-Backup- und -Restore-Vorgängen

Die folgende Abbildung zeigt HANA Studio eines Kunden, das Snapshot-Backup-Vorgänge verwendet. Das Bild zeigt, dass die HANA-Datenbank (ca. 4 TB groß) mithilfe der Snapshot Backup-Technologie in 1 Minute und 20 Sekunden und mehr als 4 Stunden bei einem dateibasierten Backup-Vorgang gesichert wird.

Der größte Teil der gesamten Laufzeit des Backup-Workflows ist die Zeit, die zur Ausführung des HANA-Backup-Speicherpunktes benötigt wird, und dieser Schritt hängt von der Belastung der HANA-Datenbank ab. Das Snapshot Backup selbst ist in wenigen Sekunden abgeschlossen.

image:anf-cba-image1.png["Diese Abbildung zeigt das HANA Studio eines Kunden mit Snapshot-Backup-Vorgängen."]



== Vergleich der Recovery-Zeitvorgaben

Dieser Abschnitt enthält einen RTO-Vergleich (Recovery Time Objective) von Datei- und Storage-basierten Snapshot Backups. Das RTO wird durch die Summe der Zeit definiert, die für das Wiederherstellen, Wiederherstellen und Starten der Datenbank benötigt wird.



=== Benötigte Zeit zum Wiederherstellen der Datenbank

Bei einem dateibasierten Backup hängt die Restore-Zeit von der Größe der Datenbank und der Backup-Infrastruktur ab, die die Restore-Geschwindigkeit in Megabyte pro Sekunde festlegt. Wenn die Infrastruktur beispielsweise einen Restore-Vorgang mit einer Geschwindigkeit von 250 MB/s unterstützt, dauert es etwa 4.5 Stunden, um eine Datenbank mit einer Größe von 4 TB auf der Persistenz wiederherzustellen.

Bei den Backups der Storage Snapshot-Kopien ist die Wiederherstellungszeit unabhängig von der Größe der Datenbank und befindet sich immer im Bereich von einigen Sekunden.



=== Benötigte Zeit zum Starten der Datenbank

Die Startzeit der Datenbank hängt von der Größe der Datenbank und der Zeit ab, die zum Laden der Daten in den Arbeitsspeicher erforderlich ist. In den folgenden Beispielen wird davon ausgegangen, dass die Daten mit 1000 MBit/s geladen werden können. Das Laden von 4 TB in den Speicher dauert etwa 1 Stunde und 10 Minuten. Bei Datei- und Snapshot-basierten Restore- und Recovery-Vorgängen ist die Startzeit identisch.


NOTE: Mit Azure NetApp Files lässt sich der Volumendurchsatz dynamisch anpassen. Vor dem Start von HANA kann der Durchsatz des HANA-Datenvolumens nach dem Start der HANA-Datenbank auf einen alltäglichen Betriebswert erhöht und gesenkt werden.



=== Benötigte Zeit für das Recovery von Datenbanken

Die Wiederherstellungszeit hängt von der Anzahl der Protokolle ab, die nach der Wiederherstellung angewendet werden müssen. Diese Zahl hängt von der Häufigkeit ab, mit der Daten-Backups erstellt werden.

Bei dateibasierten Daten-Backups wird der Backup-Zeitplan normalerweise einmal pro Tag erstellt. Eine höhere Backup-Frequenz ist normalerweise nicht möglich, da das Backup die Produktions-Performance beeinträchtigt. Daher müssen im schlimmsten Fall alle Protokolle, die während des Tages geschrieben wurden, während der Forward Recovery angewendet werden.

Snapshot Backups werden in der Regel mit höherer Frequenz geplant, da sie nicht die Performance der SAP HANA Datenbank beeinträchtigen. Wenn beispielsweise Snapshot-Backups alle sechs Stunden geplant werden, beträgt die Recovery-Zeit im schlimmsten Fall ein Viertel der Recovery-Zeit für ein dateibasiertes Backup (6 Stunden / 24 Stunden = 0.25).

Die folgende Abbildung zeigt einen Vergleich von Restore- und Recovery-Vorgängen mit einem täglichen dateibasierten Backup und Snapshot Backups mit verschiedenen Zeitplänen.

Die ersten beiden Balken zeigen, dass sie, selbst bei einem einzelnen Snapshot-Backup pro Tag, durch die Geschwindigkeit des Restore-Vorgangs aus einem Snapshot-Backup auf 43 % reduziert werden. Wenn mehrere Snapshot Backups pro Tag erstellt werden, kann die Laufzeit noch weiter reduziert werden, da bei Forward Recovery weniger Protokolle angewendet werden müssen.

Die folgende Abbildung zeigt auch, dass vier bis sechs Snapshot Backups pro Tag am sinnvollsten sind, da eine höhere Frequenz keinen großen Einfluss auf die Gesamtlaufzeit hat.

image:anf-cba-image2.png["Diese Abbildung zeigt einen Vergleich der Wiederherstellungs- und Recovery-Vorgänge mit einem täglichen dateibasierten Backup und Snapshot Backups mit unterschiedlichen Zeitplänen."]

link:anf-cba-use-cases-and-value-of-accelerated-backup-and-cloning-operations_overview.html["Weiter: Anwendungsfälle und Mehrwert beschleunigter Backup- und Klonvorgänge"]
