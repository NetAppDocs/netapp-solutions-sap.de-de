---
sidebar: sidebar 
permalink: bp/saphana_fas_fc_storage_controller_setup.html 
keywords: storage, controller, setup, storage, efficiency volume, encryption, quality, configure, disk, connection, aggregate 
summary: In diesem Abschnitt wird die Konfiguration des NetApp Storage-Systems beschrieben. Sie müssen die primäre Installation und Einrichtung gemäß den entsprechenden ONTAP Setup- und Konfigurationsleitfäden abschließen. 
---
= Einrichtung von Storage Controllern
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


[role="lead"]
In diesem Abschnitt wird die Konfiguration des NetApp Storage-Systems beschrieben. Sie müssen die primäre Installation und Einrichtung gemäß den entsprechenden ONTAP Setup- und Konfigurationsleitfäden abschließen.



== Storage-Effizienz

Inline-Deduplizierung, Inline-Deduplizierung, Inline-Komprimierung und Inline-Data-Compaction werden von SAP HANA in einer SSD-Konfiguration unterstützt.

Die Aktivierung von Storage-Effizienzfunktionen in einer HDD-Konfiguration wird nicht unterstützt.



== NetApp FlexGroup Volumes

Die Verwendung von NetApp FlexGroup Volumes wird für SAP HANA nicht unterstützt. Aufgrund der Architektur von SAP HANA bietet die Verwendung von FlexGroup Volumes keinen Vorteil und kann zu Performance-Problemen führen.



== NetApp Volume- und Aggregatverschlüsselung

Die Verwendung von NetApp Volume Encryption (NVE) und NetApp Aggregate Encryption (NAE) wird bei SAP HANA unterstützt.



== Um Servicequalität bieten zu können

QoS kann zur Begrenzung des Storage-Durchsatzes für spezifische SAP HANA Systeme eingesetzt werden. Ein Anwendungsfall wäre, den Durchsatz von Entwicklungs- und Testsystemen zu begrenzen, damit sie bei einem gemischten Setup keinen Einfluss auf die Produktionssysteme haben.

Während des Dimensionierungsprozesses müssen die Performance-Anforderungen eines nicht für die Produktion verwendeten Systems ermittelt werden. Entwicklungs- und Testsysteme haben geringere Leistungswerte, typischerweise im Bereich von 20 bis 50 % des Produktionssystems.

Ab ONTAP 9 wird QoS auf Storage-Volume-Ebene konfiguriert und verwendet die maximalen Werte für Durchsatz (MB/s) und Anzahl der I/O-Vorgänge (IOPS).

Ein großer I/O-Schreibvorgang wirkt sich am stärksten auf die Performance des Storage-Systems aus. Daher sollte die QoS-Durchsatzbegrenzung auf einen Prozentsatz der entsprechenden KPI-Werte für die SAP HANA-Speicherleistung in den Daten- und Protokoll-Volumes gesetzt werden.



== NetApp FabricPool

NetApp FabricPool darf nicht für aktive primäre Filesysteme in SAP HANA Systemen verwendet werden. Dazu gehören die Dateisysteme für den Daten- und Protokollbereich sowie die `/hana/shared` File-System. Dies führt zu unvorhersehbarer Performance, insbesondere beim Start eines SAP HANA Systems.

Die Verwendung der „nur-Snapshots“ Tiering-Politik ist möglich sowie auch die Nutzung von FabricPool im Allgemeinen an einem Backup-Ziel wie SnapVault oder SnapMirror Ziel.


NOTE: Durch die Verwendung von FabricPool für das Tiering von Snapshot Kopien im Primärspeicher oder die Verwendung von FabricPool zu einem Backup-Ziel werden die für die Wiederherstellung und das Recovery einer Datenbank oder anderer Aufgaben benötigte Zeit, beispielsweise das Erstellen von Systemklonen oder Korrektursystemen, geändert. Nehmen Sie dies bei der Planung Ihrer gesamten Lifecycle- Management-Strategie in Betracht und prüfen Sie, ob Ihre SLAs unter Verwendung dieser Funktion noch erfüllt werden.

FabricPool ist eine gute Option, um Log-Backups auf eine andere Storage Tier zu verschieben. Das Verschieben von Backups beeinträchtigt die für das Recovery einer SAP HANA Datenbank erforderliche Zeit. Daher sollte die Option „Tiering-minimum-cooling-days“ auf einen Wert gesetzt werden, der Log-Backups, die routinemäßig für die Wiederherstellung benötigt werden, auf der lokalen fast Storage Tier platziert.



== Speicher konfigurieren

In der folgenden Übersicht sind die erforderlichen Schritte zur Storage-Konfiguration zusammengefasst. Jeder Schritt wird in den nachfolgenden Abschnitten näher beschrieben. Bevor Sie diese Schritte initiieren, sollten Sie das Setup der Storage-Hardware, die Installation der ONTAP Software und die Verbindung der Speicher-FCP-Ports mit dem SAN Fabric abschließen.

. Überprüfen Sie die richtige SAS-Stack-Konfiguration, wie im Abschnitt beschrieben link:saphana_fas_fc_storage_controller_setup.html#disk-shelf-connection["Festplatten-Shelf-Verbindung."]
. Erstellen und Konfigurieren der erforderlichen Aggregate, wie im Abschnitt beschrieben link:saphana_fas_fc_storage_controller_setup.html#aggregate-configuration["Konfiguration von Aggregaten"]
. Erstellen Sie eine Storage Virtual Machine (SVM), wie im Abschnitt beschrieben link:saphana_fas_fc_storage_controller_setup.html#storage-virtual-machine-configuration["Konfiguration von Storage Virtual Machines"]
. Erstellen Sie logische Schnittstellen (LIFs), wie im Abschnitt beschrieben link:saphana_fas_fc_storage_controller_setup.html#logical-interface-configuration["Konfiguration der logischen Schnittstelle:"]
. Erstellen Sie FCP-Port-Sets, wie im Abschnitt beschrieben link:saphana_fas_fc_storage_controller_setup.html#fcp-port-sets["FCP-Port-Sätze."]
. Erstellen von Initiatorgruppen mit weltweiten Namen (WWNs) von HANA Servern, wie im Abschnitt beschrieben link:saphana_fas_fc_storage_controller_setup.html#initiator-groups["Initiatorgruppen."]
. Erstellen Sie Volumes und LUNs in den Aggregaten, wie im Abschnitt beschrieben link:saphana_fas_fc_storage_controller_setup.html#volume-and-lun-configuration-for-sap-hana-single-host-systems["Volume- und LUN-Konfiguration für SAP HANA Single-Host-Systeme"] Und link:saphana_fas_fc_storage_controller_setup.html#volume-and-lun-configuration-for-sap-hana-multiple-host-systems["Volume- und LUN-Konfiguration für SAP HANA Multiple-Host-Systeme"]




== Festplatten-Shelf-Verbindung

Mit HDDs können maximal zwei DS2246 Festplatten-Shelfs oder vier DS224C Festplatten-Shelfs mit einem SAS-Stack verbunden werden, um die erforderliche Performance für die SAP HANA-Hosts zu liefern, wie in der folgenden Abbildung dargestellt. Die Festplatten in jedem Shelf müssen gleichmäßig auf beide Controller des HA-Paars verteilt werden.

image::saphana_fas_fc_image10.png[Fehler: Fehlendes Grafikbild]

Bei SSDs kann maximal ein Platten-Shelf mit einem SAS-Stack verbunden werden, um die erforderliche Performance für die SAP HANA-Hosts zu liefern, wie in der folgenden Abbildung dargestellt. Die Festplatten in jedem Shelf müssen gleichmäßig auf beide Controller des HA-Paars verteilt werden. Mit dem DS224C Festplatten-Shelf können auch Quad-Path-SAS-Kabel verwendet werden, ist aber nicht erforderlich.

image::saphana_fas_fc_image11.png[Fehler: Fehlendes Grafikbild]



== Konfiguration von Aggregaten

Im Allgemeinen müssen zwei Aggregate pro Controller konfiguriert werden, unabhängig davon, welches Platten-Shelf oder Festplattentechnologie (SSD oder HDD) zum Einsatz kommt. Dieser Schritt ist notwendig, damit Sie alle verfügbaren Controller-Ressourcen nutzen können. Für Systeme der FAS 2000 Serie genügt ein Daten-Aggregat.



=== Aggregatkonfiguration mit HDDs

Die folgende Abbildung zeigt eine Konfiguration für acht SAP HANA-Hosts. Vier SAP HANA-Hosts sind mit jedem Storage-Controller verbunden. Zwei separate Aggregate, eines an jedem Storage Controller, sind konfiguriert. Jedes Aggregat ist mit 4 × 10 = 40 Datenfestplatten (HDDs) konfiguriert.

image::saphana_fas_fc_image12.png[Fehler: Fehlendes Grafikbild]



=== Aggregat-Konfiguration mit nur SDD-Systemen

Im Allgemeinen müssen zwei Aggregate pro Controller konfiguriert werden, unabhängig davon, welches Platten-Shelf oder Festplattentechnologie (SSDs oder HDDs) zum Einsatz kommt. Für Systeme der FAS2000 Serie reicht ein Daten-Aggregat aus.

Die folgende Abbildung zeigt eine Konfiguration mit 12 SAP HANA Hosts, die auf einem 12-GB-SAS-Shelf ausgeführt werden und mit ADPv2 konfiguriert sind. Sechs SAP-HANA-Hosts sind mit jedem Storage-Controller verbunden. Vier separate Aggregate, zwei an jedem Storage Controller, sind konfiguriert. Jedes Aggregat ist mit 11 Festplatten mit neun Daten und zwei Parity-Festplatten-Partitionen konfiguriert. Für jeden Controller stehen zwei Ersatzpartitionen zur Verfügung.

image::saphana_fas_fc_image13.jpg[Fehler: Fehlendes Grafikbild]



== Konfiguration von Storage Virtual Machines

SAP Landschaften mit SAP HANA Datenbanken aus mehreren Hosts können eine einzige SVM verwenden. Falls erforderlich, kann jeder SAP-Landschaft auch eine SVM zugewiesen werden, falls diese von verschiedenen Teams innerhalb eines Unternehmens gemanagt werden. Die Screenshots und die Befehlsausgaben in diesem Dokument verwenden eine SVM mit dem Namen `hana`.



== Konfiguration der logischen Schnittstelle

Innerhalb der Storage-Cluster-Konfiguration muss eine Netzwerkschnittstelle (LIF) erstellt und einem dedizierten FCP-Port zugewiesen werden. Wenn beispielsweise vier FCP-Ports aus Performance-Gründen erforderlich sind, müssen vier LIFs erstellt werden. Die folgende Abbildung zeigt einen Screenshot der vier LIFs (mit dem Namen `fc_*_*)` Die auf dem konfiguriert wurden `hana` SVM:

image::saphana_fas_fc_image14.jpeg[Fehler: Fehlendes Grafikbild]

Während der SVM-Erstellung mit ONTAP 9.8 System Manager können alle erforderlichen physischen FCP-Ports ausgewählt und automatisch eine LIF pro physischem Port erstellt werden.

Die folgende Abbildung zeigt die Erstellung von SVM und LIFs mit ONTAP 9.8 System Manager.

image::saphana_fas_fc_image15.jpeg[Fehler: Fehlendes Grafikbild]



== FCP-Port-Sätze

Ein FCP-Port-Satz wird verwendet, um zu definieren, welche LIFs von einer bestimmten Initiatorgruppe verwendet werden sollen. In der Regel werden alle für HANA-Systeme erstellten LIFs in demselben Portsatz platziert. Die folgende Abbildung zeigt die Konfiguration eines PortSatzes mit dem Namen 32g, der die vier bereits erstellten LIFs enthält.

image::saphana_fas_fc_image16.jpeg[Fehler: Fehlendes Grafikbild]


NOTE: Bei ONTAP 9.8 ist kein Portsatz erforderlich, kann aber über die Befehlszeile erstellt und verwendet werden.



== Initiatorgruppen

Eine Initiatorgruppe kann für jeden Server oder für eine Gruppe von Servern konfiguriert werden, die Zugriff auf eine LUN benötigen. Für die iGroup Konfiguration sind die weltweiten Port-Namen (WWPNs) der Server erforderlich.

Verwenden der `sanlun` Führen Sie den folgenden Befehl aus, um die WWPNs jedes SAP HANA-Hosts abzurufen:

....
stlrx300s8-6:~ # sanlun fcp show adapter
/sbin/udevadm
/sbin/udevadm

host0 ...... WWPN:2100000e1e163700
host1 ...... WWPN:2100000e1e163701
....

NOTE: Der `sanlun` Tool ist Teil der NetApp Host Utilities und muss auf jedem SAP HANA Host installiert sein. Mehr Details finden Sie in Abschnitt link:saphana_fas_fc_host_setup.html["Hosteinrichtung:"]

Die folgende Abbildung zeigt die Liste der Initiatoren für SS3_HANA. Die Initiatorgruppe enthält alle WWPNs der Server und ist dem Port-Satz des Storage Controllers zugewiesen.

image::saphana_fas_fc_image17.jpeg[Fehler: Fehlendes Grafikbild]



== Volume- und LUN-Konfiguration für SAP HANA Single-Host-Systeme

Die folgende Abbildung zeigt die Volume-Konfiguration von vier SAP HANA-Systemen mit einem Host. Die Daten- und Protokoll-Volumes jedes SAP HANA Systems werden auf verschiedene Storage Controller verteilt. Beispiel: Volume `SID1`_`data`_`mnt00001 `is configured on controller A and volume `SID1`_`log`_`mnt00001` Ist auf Controller B konfiguriert Für jedes Volume wird eine einzelne LUN konfiguriert.


NOTE: Wird für die SAP HANA Systeme nur ein Storage-Controller eines Hochverfügbarkeitspaars (HA) verwendet, können Daten-Volumes und Protokoll-Volumes auch auf demselben Storage Controller gespeichert werden.

image::saphana_fas_fc_image18.jpg[Fehler: Fehlendes Grafikbild]

Für jeden SAP HANA-Host, ein Daten-Volume, ein Protokoll-Volume und ein Volume für `/hana/shared` Werden konfiguriert. Die folgende Tabelle zeigt eine Beispielkonfiguration mit vier SAP HANA Single-Host-Systemen.

|===
| Zweck | Aggregat 1 bei Controller A | Aggregat 2 bei Controller A | Aggregat 1 bei Controller B | Aggregieren 2 bei Controller B 


| Daten-, Protokoll- und freigegebene Volumes für System SID1 | Datenvolumen: SID1_Data_mnt00001 | Freigegebenes Volume: SID1_Shared | – | Protokollvolumen: SID1_log_mnt00001 


| Daten-, Protokoll- und freigegebene Volumes für System SID2 | – | Protokollvolumen: SID2_log_mnt00001 | Datenvolumen: SID2_Data_mnt00001 | Freigegebenes Volume: SID2_Shared 


| Daten-, Protokoll- und gemeinsam genutzte Volumes für System SID3 | Gemeinsam genutztes Volume: SID3_shared | Datenvolumen: SID3_Data_mnt00001 | Protokollvolumen: SID3_log_mnt00001 | – 


| Daten-, Protokoll- und gemeinsam genutzte Volumes für System SID4 | Protokollvolumen: SID4_log_mnt00001 | – | Gemeinsam genutztes Volume: SID4_shared | Datenvolumen: SID4_Data_mnt00001 
|===
Die nächste Tabelle zeigt ein Beispiel für die Mount-Point-Konfiguration für ein System mit einem einzelnen Host.

|===
| LUN | Bereitstellungspunkt beim HANA-Host | Hinweis 


| SID1_Data_mnt00001 | /hana/Data/SID1/mnt00001 | Mit /etc/fstab-Eintrag montiert 


| SID1_log_mnt00001 | /hana/log/SID1/mnt00001 | Mit /etc/fstab-Eintrag montiert 


| SID1_Shared | /hana/Shared/SID1 | Mit /etc/fstab-Eintrag montiert 
|===

NOTE: Mit der beschriebenen Konfiguration wird der verwendet `/usr/sap/SID1` Verzeichnis, in dem das Standard-Home-Verzeichnis des Benutzers SID1adm gespeichert ist, befindet sich auf der lokalen Festplatte. Für ein Disaster Recovery mit festplattenbasierter Replizierung empfiehlt NetApp die Erstellung einer zusätzlichen LUN innerhalb von `SID1`_`shared `volume for the `/usr/sap/SID1` Verzeichnis so dass alle Dateisysteme auf dem zentralen Speicher sind.



== Volume- und LUN-Konfiguration für SAP HANA Single-Host-Systeme mit Linux LVM

Der Linux LVM kann verwendet werden, um die Leistung zu steigern und um LUN-Größenbeschränkungen zu beheben. Die verschiedenen LUNs einer LVM Volume-Gruppe sollten in einem anderen Aggregat und einem anderen Controller gespeichert werden. Die folgende Tabelle enthält ein Beispiel für zwei LUNs pro Volume-Gruppe.


NOTE: Zur Erfüllung der SAP HANA-KPIs ist es nicht erforderlich, LVM mit mehreren LUNs zu verwenden. Ein einzelnes LUN-Setup erfüllt die erforderlichen KPIs.

|===
| Zweck | Aggregat 1 bei Controller A | Aggregat 2 bei Controller A | Aggregat 1 bei Controller B | Aggregieren 2 bei Controller B 


| Daten-, Protokoll- und gemeinsam genutzte Volumes für LVM-basierte Systeme | Datenvolumen: SID1_Data_mnt00001 | Gemeinsames Volume: SID1_Shared Log2 Volume: SID1_log2_mnt00001 | Daten2 Volumen: SID1_data2_mnt00001 | Protokollvolumen: SID1_log_mnt00001 
|===
Auf dem SAP HANA-Host müssen Volume-Gruppen und logische Volumes erstellt und eingebunden werden. In der nächsten Tabelle werden die Mount-Punkte für Einzelhostsysteme mit LVM aufgeführt.

|===
| Logisches Volume/LUN | Bereitstellungspunkt beim SAP HANA-Host | Hinweis 


| LV: SID1_Data_mnt0000-vol | /hana/Data/SID1/mnt00001 | Mit /etc/fstab-Eintrag montiert 


| LV: SID1_log_mnt00001-vol | /hana/log/SID1/mnt00001 | Mit /etc/fstab-Eintrag montiert 


| LUN: SID1_Shared | /hana/Shared/SID1 | Mit /etc/fstab-Eintrag montiert 
|===

NOTE: Mit der beschriebenen Konfiguration wird der verwendet `/usr/sap/SID1` Verzeichnis, in dem das Standard-Home-Verzeichnis des Benutzers SID1adm gespeichert ist, befindet sich auf der lokalen Festplatte. Für ein Disaster Recovery mit festplattenbasierter Replizierung empfiehlt NetApp die Erstellung einer zusätzlichen LUN innerhalb von `SID1`_`shared `volume for the `/usr/sap/SID1` Verzeichnis so dass alle Dateisysteme auf dem zentralen Speicher sind.



== Volume- und LUN-Konfiguration für SAP HANA Multiple-Host-Systeme

Die folgende Abbildung zeigt die Volume-Konfiguration eines SAP HANA Systems mit 4+1 und mehreren Hosts. Die Daten-Volumes und Protokoll-Volumes jedes SAP HANA-Hosts werden auf verschiedene Storage-Controller verteilt. Beispiel: Das Volume `SID`_`data`_`mnt00001` Wird für Controller A und Volume konfiguriert `SID`_`log`_`mnt00001` Ist auf Controller B konfiguriert Eine LUN ist innerhalb jedes Volumes konfiguriert.

Der `/hana/shared` Das Volume muss von allen HANA-Hosts zugänglich sein und wird daher mithilfe von NFS exportiert. Obwohl es für die keine spezifischen Performance-KPIs gibt `/hana/shared` NetApp empfiehlt die Verwendung einer 10-Gbit-Ethernet-Verbindung.


NOTE: Wenn für das SAP HANA System nur ein Storage-Controller eines HA-Paars verwendet wird, können Daten- und Protokoll-Volumes auch auf demselben Storage Controller gespeichert werden.

image::saphana_fas_fc_image19.jpg[Fehler: Fehlendes Grafikbild]

Für jeden SAP HANA-Host werden ein Daten-Volume und ein Protokoll-Volume erstellt. Der `/hana/shared` Das Volume wird von allen Hosts des SAP HANA-Systems verwendet. Die folgende Abbildung zeigt eine Beispielkonfiguration für ein SAP HANA System mit 4+1 mehreren Hosts.

|===
| Zweck | Aggregat 1 bei Controller A | Aggregat 2 bei Controller A | Aggregat 1 bei Controller B | Aggregieren 2 bei Controller B 


| Daten- und Protokoll-Volumes für Node 1 | Datenvolumen: SID_Data_mnt00001 | – | Protokollvolumen: SID_log_mnt00001 | – 


| Daten- und Protokoll-Volumes für Node 2 | Protokollvolumen: SID_log_mnt002 | – | Datenvolumen: SID_Data_mnt002 | – 


| Daten- und Protokoll-Volumes für Node 3 | – | Datenvolumen: SID_Data_mnt00003 | – | Protokollvolumen: SID_log_mnt00003 


| Daten- und Protokoll-Volumes für Node 4 | – | Protokollvolumen: SID_log_mnt004 | – | Datenvolumen: SID_Data_mnt00004 


| Gemeinsames Volume für alle Hosts | Gemeinsam genutztes Volume: SID_shared | – | – | – 
|===
Die nächste Tabelle zeigt die Konfiguration und die Mount-Punkte eines Systems mit mehreren Hosts mit vier aktiven SAP HANA-Hosts.

|===
| LUN oder Volume | Bereitstellungspunkt beim SAP HANA-Host | Hinweis 


| LUN: SID_Data_mnt00001 | /hana/Data/SID/mnt00001 | Montiert mit Speicheranschluss 


| LUN: SID_log_mnt00001 | /hana/log/SID/mnt00001 | Montiert mit Speicheranschluss 


| LUN: SID_Data_mnt002 | /hana/Data/SID/mnt002 | Montiert mit Speicheranschluss 


| LUN: SID_log_mnt002 | /hana/log/SID/mnt002 | Montiert mit Speicheranschluss 


| LUN: SID_Data_mnt003 | /hana/Data/SID/mnt003 | Montiert mit Speicheranschluss 


| LUN: SID_log_mnt003 | /hana/log/SID/mnt003 | Montiert mit Speicheranschluss 


| LUN: SID_Data_mnt004 | /hana/Data/SID/mnt004 | Montiert mit Speicheranschluss 


| LUN: SID_log_mnt004 | /hana/log/SID/mnt004 | Montiert mit Speicheranschluss 


| Volume: SID_Shared | /hana/Shared/SID | Gemountet auf allen Hosts mit NFS und /etc/fstab Eintrag 
|===

NOTE: Mit der beschriebenen Konfiguration wird der verwendet `/usr/sap/SID` Verzeichnis, in dem das Standard-Home-Verzeichnis des Benutzers SIDadm gespeichert ist, befindet sich auf der lokalen Festplatte für jeden HANA-Host. Bei einem Disaster Recovery Setup mit festplattenbasierter Replizierung empfiehlt NetApp das Erstellen von vier zusätzlichen Unterverzeichnissen in `SID`_`shared` Volume für das `/usr/sap/SID` Dateisystem so, dass jeder Datenbank-Host alle seine Dateisysteme auf dem zentralen Speicher hat.



== Volume- und LUN-Konfiguration für SAP HANA Systeme mit mehreren Hosts unter Verwendung von Linux LVM

Der Linux LVM kann verwendet werden, um die Leistung zu steigern und um LUN-Größenbeschränkungen zu beheben. Die verschiedenen LUNs einer LVM Volume-Gruppe sollten in einem anderen Aggregat und einem anderen Controller gespeichert werden. Die folgende Tabelle zeigt ein Beispiel für zwei LUNs pro Volume-Gruppe für ein 2+1 SAP HANA System mit mehreren Hosts.


NOTE: Es ist nicht notwendig, LVM zu verwenden, um mehrere LUN zu kombinieren, um die SAP HANA-KPIs zu erfüllen. Ein einzelnes LUN-Setup erfüllt die erforderlichen KPIs.

|===
| Zweck | Aggregat 1 bei Controller A | Aggregat 2 bei Controller A | Aggregat 1 bei Controller B | Aggregieren 2 bei Controller B 


| Daten- und Protokoll-Volumes für Node 1 | Datenvolumen: SID_Data_mnt00001 | Log2-Volumen: SID_log2_mnt00001 | Protokollvolumen: SID_log_mnt00001 | Daten2 Volumen: SID_data2_mnt00001 


| Daten- und Protokoll-Volumes für Node 2 | Log2-Volumen: SID_log2_mnt002 | Datenvolumen: SID_Data_mnt002 | Daten2 Volumen: SID_data2_mnt002 | Protokollvolumen: SID_log_mnt002 


| Gemeinsames Volume für alle Hosts | Gemeinsam genutztes Volume: SID_shared | – | – | – 
|===
Auf dem SAP HANA-Host müssen Volume-Gruppen und logische Volumes erstellt und eingebunden werden:

|===
| Logisches Volumen (LV) oder Volumen | Bereitstellungspunkt beim SAP HANA-Host | Hinweis 


| LV: SID_Data_mnt00001-vol | /hana/Data/SID/mnt00001 | Montiert mit Speicheranschluss 


| LV: SID_log_mnt00001-vol | /hana/log/SID/mnt00001 | Montiert mit Speicheranschluss 


| LV: SID_Data_mnt002-vol | /hana/Data/SID/mnt002 | Montiert mit Speicheranschluss 


| LV: SID_Log_mnt002-vol | /hana/log/SID/mnt002 | Montiert mit Speicheranschluss 


| Volume: SID_Shared | /hana/Shared | Gemountet auf allen Hosts mit NFS und /etc/fstab Eintrag 
|===

NOTE: Mit der beschriebenen Konfiguration wird der verwendet `/usr/sap/SID` Verzeichnis, in dem das Standard-Home-Verzeichnis des Benutzers SIDadm gespeichert ist, befindet sich auf der lokalen Festplatte für jeden HANA-Host. Bei einem Disaster Recovery Setup mit festplattenbasierter Replizierung empfiehlt NetApp das Erstellen von vier zusätzlichen Unterverzeichnissen in `SID`_`shared` Volume für das `/usr/sap/SID` Dateisystem so, dass jeder Datenbank-Host alle seine Dateisysteme auf dem zentralen Speicher hat.



== Volume-Optionen

Die in der folgenden Tabelle aufgeführten Volume-Optionen müssen geprüft und auf allen SVMs eingestellt werden.

|===
| Aktion | ONTAP 9 


| Deaktivieren Sie automatische Snapshot Kopien | vol modify –vserver <vserver-Name> -Volume <volname> -Snapshot-Policy keine 


| Deaktivieren Sie die Sichtbarkeit des Snapshot Verzeichnisses | vol modify -vserver <vserver-Name> -Volume <volname> -Snapdir-Access false 
|===


== Erstellen von LUNs, Volumes und Zuordnen von LUNs zu Initiatorgruppen

Mit NetApp OnCommand System Manager können Storage Volumes und LUNs erstellt und den Initiatorgruppen der Server zugeordnet werden.

Die folgenden Schritte zeigen die Konfiguration eines 2+1-HANA-Systems mit mehreren Hosts und SID SS3.

. Starten Sie den Assistenten „LUN erstellen“ in NetApp ONTAP System Manager.
+
image::saphana_fas_fc_image20.jpeg[Fehler: Fehlendes Grafikbild]

. Geben Sie den LUN-Namen ein, wählen Sie den LUN-Typ aus und geben Sie die Größe der LUN ein.
+
image::saphana_fas_fc_image21.jpeg[Fehler: Fehlendes Grafikbild]

. Geben Sie den Volume-Namen und das Hosting-Aggregat ein.
+
image::saphana_fas_fc_image22.jpeg[Fehler: Fehlendes Grafikbild]

. Wählen Sie die Initiatorgruppen aus, denen die LUNs zugeordnet werden sollen.
+
image::saphana_fas_fc_image23.jpeg[Fehler: Fehlendes Grafikbild]

. Stellen Sie die QoS-Einstellungen bereit.
+
image::saphana_fas_fc_image24.jpeg[Fehler: Fehlendes Grafikbild]

. Klicken Sie auf der Übersichtsseite auf Weiter.
+
image::saphana_fas_fc_image25.jpeg[Fehler: Fehlendes Grafikbild]

. Klicken Sie auf der Fertigungsseite auf Fertig stellen.
+
image::saphana_fas_fc_image26.jpeg[Fehler: Fehlendes Grafikbild]

. Wiederholen Sie die Schritte 2 bis 7 für jede LUN.
+
Die folgende Abbildung zeigt eine Zusammenfassung aller LUNs, die für die Einrichtung von 2+1 mit mehreren Hosts erstellt werden müssen.

+
image::saphana_fas_fc_image27.jpeg[Fehler: Fehlendes Grafikbild]





== Erstellen von LUNs, Volumes und Zuordnen von LUNs zu Initiatorgruppen über die CLI

Dieser Abschnitt zeigt eine Beispielkonfiguration mit der Befehlszeile mit ONTAP 9.8 für ein 2+1 SAP HANA mehrere Hostsysteme mit SID FC5 unter Verwendung von LVM und zwei LUNs pro LVM Volume-Gruppe.

. Erstellung aller erforderlichen Volumes
+
....
vol create -volume FC5_data_mnt00001 -aggregate aggr1_1 -size 1200g  -snapshot-policy none -foreground true -encrypt false  -space-guarantee none
vol create -volume FC5_log_mnt00002  -aggregate aggr2_1 -size 280g  -snapshot-policy none -foreground true -encrypt false  -space-guarantee none
vol create -volume FC5_log_mnt00001  -aggregate aggr1_2 -size 280g -snapshot-policy none -foreground true -encrypt false -space-guarantee none
vol create -volume FC5_data_mnt00002  -aggregate aggr2_2 -size 1200g -snapshot-policy none -foreground true -encrypt false -space-guarantee none
vol create -volume FC5_data2_mnt00001 -aggregate aggr1_2 -size 1200g -snapshot-policy none -foreground true -encrypt false -space-guarantee none
vol create -volume FC5_log2_mnt00002  -aggregate aggr2_2 -size 280g -snapshot-policy none -foreground true -encrypt false -space-guarantee none
vol create -volume FC5_log2_mnt00001  -aggregate aggr1_1 -size 280g -snapshot-policy none -foreground true -encrypt false  -space-guarantee none
vol create -volume FC5_data2_mnt00002  -aggregate aggr2_1 -size 1200g -snapshot-policy none -foreground true -encrypt false -space-guarantee none
vol create -volume FC5_shared -aggregate aggr1_1 -size 512g -state online -policy default -snapshot-policy none -junction-path /FC5_shared -encrypt false  -space-guarantee none
....
. Erstellen Sie alle LUNs.
+
....
lun create -path  /vol/FC5_data_mnt00001/FC5_data_mnt00001   -size 1t -ostype linux -space-reserve disabled -space-allocation disabled -class regular
lun create -path /vol/FC5_data2_mnt00001/FC5_data2_mnt00001 -size 1t -ostype linux -space-reserve disabled -space-allocation disabled -class regular
lun create -path /vol/FC5_data_mnt00002/FC5_data_mnt00002 -size 1t -ostype linux -space-reserve disabled -space-allocation disabled -class regular
lun create -path /vol/FC5_data2_mnt00002/FC5_data2_mnt00002 -size 1t -ostype linux -space-reserve disabled -space-allocation disabled -class regular
lun create -path /vol/FC5_log_mnt00001/FC5_log_mnt00001 -size 260g -ostype linux -space-reserve disabled -space-allocation disabled -class regular
lun create -path /vol/FC5_log2_mnt00001/FC5_log2_mnt00001 -size 260g -ostype linux -space-reserve disabled -space-allocation disabled -class regular
lun create -path /vol/FC5_log_mnt00002/FC5_log_mnt00002 -size 260g -ostype linux -space-reserve disabled -space-allocation disabled -class regular
lun create -path /vol/FC5_log2_mnt00002/FC5_log2_mnt00002 -size 260g -ostype linux -space-reserve disabled -space-allocation disabled -class regular
....
. Erstellen Sie die Initiatorgruppe für alle Server, die zu System FC5 gehören.
+
....
lun igroup create -igroup HANA-FC5 -protocol fcp -ostype linux -initiator 10000090fadcc5fa,10000090fadcc5fb, 10000090fadcc5c1,10000090fadcc5c2,  10000090fadcc5c3,10000090fadcc5c4 -vserver hana
....
. Ordnen Sie alle LUNs der erstellten Initiatorgruppe zu.
+
....
lun map -path  /vol/FC5_data_mnt00001/FC5_data_mnt00001    -igroup HANA-FC5
lun map -path /vol/FC5_data2_mnt00001/FC5_data2_mnt00001  -igroup HANA-FC5
lun map -path /vol/FC5_data_mnt00002/FC5_data_mnt00002  -igroup HANA-FC5
lun map -path /vol/FC5_data2_mnt00002/FC5_data2_mnt00002  -igroup HANA-FC5
lun map -path /vol/FC5_log_mnt00001/FC5_log_mnt00001  -igroup HANA-FC5
lun map -path /vol/FC5_log2_mnt00001/FC5_log2_mnt00001  -igroup HANA-FC5
lun map -path /vol/FC5_log_mnt00002/FC5_log_mnt00002  -igroup HANA-FC5
lun map -path /vol/FC5_log2_mnt00002/FC5_log2_mnt00002  -igroup HANA-FC5
....

